
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://07th-mod.com/developer/legacy/code-overview/">
      
      
        <link rel="prev" href="../../installer/install-data-json/">
      
      
        <link rel="next" href="../technical-details/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Old Batch File Installer - 07th-Mod - User Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#installer-code" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="07th-Mod - User Wiki" class="md-header__button md-logo" aria-label="07th-Mod - User Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            07th-Mod - User Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Old Batch File Installer
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/07th-mod" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    07th-Mod (Organization)
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="07th-Mod - User Wiki" class="md-nav__button md-logo" aria-label="07th-Mod - User Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    07th-Mod - User Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/07th-mod" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    07th-Mod (Organization)
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <b>Higurashi</b>
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            <b>Higurashi</b>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/Higurashi-Getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/Higurashi-Part-1---Voice-and-Graphics-Patch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2a. Installer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/Manual-Installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2b. Manual Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/Higurashi-Part-2---Patch-configuration-and-keyboard-shortcuts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2c. Shortcuts and Settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/Higurashi-Part-1.1---Voices-only-Patch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Voices-only Patch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/FAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/FAQ-linux-steam-deck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4a. Linux & Steam Deck FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/BGM-SE-FAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4b. BGM/SE FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/MiotsukushiFAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4c. Miotsukushi FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Getting Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Higurashi/Uninstall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Uninstalling Mod & Game
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <b>Umineko</b>
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            <b>Umineko</b>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Umineko/Umineko-Getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Intro (START HERE)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Umineko/Umineko-Mod-Options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Mod Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Umineko/Umineko-Part-3a-Cross-Platform-Installer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3a. Cross-Platform Installer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Umineko/Umineko-Part-1---Voice-and-Graphics-Patch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3b. Manual Voice and Graphics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Umineko/Umineko-Part-1.1---Voices-only-Patch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3c. Manual Voices-only
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Umineko/Umineko-Part-0-TroubleShooting-and-FAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. FAQ/Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Umineko/support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Getting Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Umineko/Uninstall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Uninstalling Mod & Game
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <b>Installer</b>
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            <b>Installer</b>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Installer/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Installer/support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Getting support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Installer/power-users/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Power User Installation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Donations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Donations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rules
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Support and Reporting Issues
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Beginners-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribution Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Credits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credits
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Higurashi Developer Information
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Higurashi Developer Information
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_1" >
        
          
          <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Overview
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preparing a New Chapter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/patch-folder-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Patch Folder Structure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patch-compiler/how-to-use-higurashi-patch-compiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Higurashi Patch Compiler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_3" >
        
          
          <label class="md-nav__link" for="__nav_10_3" id="__nav_10_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Game Scripting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_3">
            <span class="md-nav__icon md-icon"></span>
            Game Scripting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripting/on-scripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scripting Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripting/syntax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mod Syntax Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripting/bgm-se-scripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BGM & SE Scripting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_4" >
        
          
          <label class="md-nav__link" for="__nav_10_4" id="__nav_10_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Translation Work
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_4">
            <span class="md-nav__icon md-icon"></span>
            Translation Work
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../translation/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../translation/resources-and-guidelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources and Guidelines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../translation/console-exclusive-content/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Console Exclusive Content
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../translation/censorship-script-changes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Censorship / Script Changes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
        
          
          <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Graphical Work
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            Graphical Work
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/psd-files-templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PSD Files, Templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/resources-technical-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources, Technical Details
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/sunset-night-filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sunset/Night Filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/mangagamer-sprite-edits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mangagamer Sprite Edits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/background-image-panning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Background/Image Panning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_6" >
        
          
          <label class="md-nav__link" for="__nav_10_6" id="__nav_10_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UI Editing Scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_6">
            <span class="md-nav__icon md-icon"></span>
            UI Editing Scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sharedassets/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sharedassets/ui-editing-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Voices
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            Voices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voice/voice-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Voice Details
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voice/automated-voice-inserter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automated Voice Inserter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voice/manual-work-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manual Work Details
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_8" >
        
          
          <label class="md-nav__link" for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DLL Modding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_8">
            <span class="md-nav__icon md-icon"></span>
            DLL Modding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dll/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dll/modded-engine-flags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modded engine flags
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_9" >
        
          
          <label class="md-nav__link" for="__nav_10_9" id="__nav_10_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_9">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/git-line-endings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git Line Endings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_10" >
        
          
          <label class="md-nav__link" for="__nav_10_10" id="__nav_10_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_10">
            <span class="md-nav__icon md-icon"></span>
            Installer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installer/install-data-json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    installData.json
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_11" checked>
        
          
          <label class="md-nav__link" for="__nav_10_11" id="__nav_10_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Legacy Pages (out of date)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10_11">
            <span class="md-nav__icon md-icon"></span>
            Legacy Pages (out of date)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Old Batch File Installer
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Old Batch File Installer
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#colored-text" class="md-nav__link">
    <span class="md-ellipsis">
      Colored text
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeout" class="md-nav__link">
    <span class="md-ellipsis">
      timeout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nul" class="md-nav__link">
    <span class="md-ellipsis">
      nul
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aria2c" class="md-nav__link">
    <span class="md-ellipsis">
      aria2c
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7za" class="md-nav__link">
    <span class="md-ellipsis">
      7za
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#powershell" class="md-nav__link">
    <span class="md-ellipsis">
      powershell
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    <span class="md-ellipsis">
      set
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xcopy" class="md-nav__link">
    <span class="md-ellipsis">
      xcopy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rmdir-mkdir-and-del" class="md-nav__link">
    <span class="md-ellipsis">
      rmdir, mkdir and del
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../technical-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Old Advanced Installer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adv-mode-and-lipsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adv Mode and Lipsync
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#colored-text" class="md-nav__link">
    <span class="md-ellipsis">
      Colored text
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeout" class="md-nav__link">
    <span class="md-ellipsis">
      timeout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nul" class="md-nav__link">
    <span class="md-ellipsis">
      nul
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aria2c" class="md-nav__link">
    <span class="md-ellipsis">
      aria2c
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7za" class="md-nav__link">
    <span class="md-ellipsis">
      7za
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#powershell" class="md-nav__link">
    <span class="md-ellipsis">
      powershell
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    <span class="md-ellipsis">
      set
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xcopy" class="md-nav__link">
    <span class="md-ellipsis">
      xcopy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rmdir-mkdir-and-del" class="md-nav__link">
    <span class="md-ellipsis">
      rmdir, mkdir and del
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<blockquote>
<p>Written by @ItaloKnox</p>
</blockquote>
<p>In this article, we are going to make a breakdown of all the installer code, written in Windows batch (<code>*.bat</code>). See the previous page for more information on how the patch is installed, the dependencies and file it uses to complete the installation.</p>
<p>Below is a snapshot of the full code from a stable Higurashi installer release. The actual breakdown should be <strong>below</strong> the code.</p>
<p>Use the index below to navigate around the page:</p>
<ul>
<li><a href="#installer-code">Installer code</a><ul>
<li><a href="#colored-text">Colored text</a></li>
<li><a href="#timeout">timeout</a></li>
<li><a href="#nul">nul</a></li>
<li><a href="#aria2c">aria2c</a></li>
<li><a href="#7za">7za</a></li>
<li><a href="#powershell">powershell</a></li>
<li><a href="#set">set</a></li>
<li><a href="#xcopy">xcopy</a></li>
<li><a href="#rmdir-mkdir-and-del">rmdir, mkdir and del</a></li>
</ul>
</li>
<li><a href="#updater-code">Updater code</a></li>
<li><a href="#flowchart">Flowchart</a><ul>
<li><a href="#if-exist">if exist</a></li>
<li><a href="#fc">fc</a></li>
</ul>
</li>
</ul>
<h1 id="installer-code">Installer code<a class="headerlink" href="#installer-code" title="Permanent link">&para;</a></h1>
<div class="highlight"><pre><span></span><code><span class="p">@</span><span class="k">echo</span> off
<span class="k">SETLOCAL</span> EnableDelayedExpansion
<span class="k">for</span> <span class="k">/F</span> <span class="s2">&quot;tokens=1,2 delims=#&quot;</span> <span class="se">%%</span>a <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;&quot;prompt #$H#$E# &amp; echo on &amp; for </span><span class="se">%%</span><span class="s1">b in (1) do     rem&quot;&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="p">(</span>
  <span class="k">set</span> <span class="s2">&quot;DEL=</span><span class="se">%%</span><span class="s2">a&quot;</span>
<span class="p">)</span>

<span class="k">set</span> <span class="nv">version</span><span class="p">=</span>v4.0.1

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Downloading graphics patch... (1 of 3)&quot;</span>
<span class="k">echo</span>.
timeout /t 1 <span class="p">&gt;</span> nul
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/resources/releases/download/Nipah/Onikakushi-CG.zip
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/resources/releases/download/Nipah/Onikakushi-CGAlt.zip
timeout /t 1 <span class="p">&gt;</span> nul

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Downloading voice patch... (2 of 3)&quot;</span>
<span class="k">echo</span>.
timeout /t 1 <span class="p">&gt;</span> nul
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/resources/releases/download/Nipah/Onikakushi-Voices.zip
timeout /t 1 <span class="p">&gt;</span> nul

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Downloading patch... (3 of 3)&quot;</span>
<span class="k">echo</span>.
timeout /t 1 <span class="p">&gt;</span> nul
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/onikakushi/releases/download/<span class="nv">%version%</span>/Onikakushi.Voice.and.Graphics.Patch.<span class="nv">%version%</span>.zip
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/resources/releases/download/Nipah/Higurashi-Textboxes.zip
.\aria2c.exe https://github.com/07th-mod/resources/raw/master/onikakushi/updater.bat
timeout /t 1 <span class="p">&gt;</span> nul

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Checking for incomplete downloads...&quot;</span>
<span class="k">echo</span>.
timeout /t 1 <span class="p">&gt;</span> nul
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/onikakushi/releases/download/<span class="nv">%version%</span>/Onikakushi.Voice.and.Graphics.Patch.<span class="nv">%version%</span>.zip
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/resources/releases/download/Nipah/Higurashi-Textboxes.zip
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/resources/releases/download/Nipah/Onikakushi-Voices.zip
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/resources/releases/download/Nipah/Onikakushi-CG.zip
.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/resources/releases/download/Nipah/Onikakushi-CGAlt.zip
timeout /t 1 <span class="p">&gt;</span> nul

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Extracting files...&quot;</span>
<span class="k">echo</span>.
timeout /t 1 <span class="p">&gt;</span> nul
.\7za.exe x Onikakushi-CGAlt.zip
.\7za.exe x Onikakushi-CG.zip
.\7za.exe x Onikakushi-Voices.zip
.\7za.exe x Onikakushi.Voice.and.Graphics.Patch.*.zip
.\7za.exe x Higurashi-Textboxes.zip -aoa
<span class="k">rmdir</span> /S /Q ..\StreamingAssets\CG <span class="p">&gt;</span> nul
<span class="k">rmdir</span> /S /Q ..\StreamingAssets\CGAlt <span class="p">&gt;</span> nul
timeout /t 1 <span class="p">&gt;</span> nul

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Moving folders...&quot;</span>
<span class="k">echo</span>.
<span class="k">echo</span> D <span class="p">|</span> xcopy /E /Y .\Managed ..\Managed <span class="p">&gt;</span> nul
<span class="k">echo</span> D <span class="p">|</span> xcopy /E /Y .\CGAlt ..\StreamingAssets\CGAlt <span class="p">&gt;</span> nul
<span class="k">echo</span> D <span class="p">|</span> xcopy /E /Y .\CG ..\StreamingAssets\CG <span class="p">&gt;</span> nul
<span class="k">echo</span> D <span class="p">|</span> xcopy /E /Y .\voice ..\StreamingAssets\voice <span class="p">&gt;</span> nul
<span class="k">echo</span> D <span class="p">|</span> xcopy /E /Y .\StreamingAssets ..\StreamingAssets <span class="p">&gt;</span> nul
<span class="k">mkdir</span> ..\StreamingAssets\BGMAlt
<span class="k">mkdir</span> ..\StreamingAssets\voiceAlt
<span class="k">mkdir</span> ..\StreamingAssets\SEAlt

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Deleting useless files...&quot;</span>
<span class="k">echo</span>.
timeout /t 1 <span class="p">&gt;</span> nul
<span class="k">rmdir</span> /S /Q .\CG <span class="p">&gt;</span> nul
<span class="k">rmdir</span> /S /Q .\CGAlt <span class="p">&gt;</span> nul
<span class="k">rmdir</span> /S /Q .\StreamingAssets <span class="p">&gt;</span> nul
<span class="k">rmdir</span> /S /Q .\voice <span class="p">&gt;</span> nul
<span class="k">rmdir</span> /S /Q .\Managed <span class="p">&gt;</span> nul
<span class="k">del</span> .\*.zip <span class="p">&gt;</span> nul
<span class="k">del</span> ..\StreamingAssets\CompiledUpdateScripts\*.mg <span class="p">&gt;</span> nul
timeout /t 1 <span class="p">&gt;</span> nul

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;All done, finishing in three seconds...&quot;</span>
timeout /t 3 <span class="p">&gt;</span> nul

<span class="k">exit</span>
<span class="p">:</span><span class="nl">colorEcho</span>
<span class="k">echo</span> off
<span class="p">&lt;</span>nul <span class="k">set</span> <span class="k">/p</span> <span class="s2">&quot;.=</span><span class="nv">%DEL%</span><span class="s2">&quot;</span> <span class="p">&gt;</span> <span class="s2">&quot;</span><span class="nv">%~2</span><span class="s2">&quot;</span>
findstr /v /a:<span class="nv">%1</span> /R <span class="s2">&quot;^$&quot;</span> <span class="s2">&quot;</span><span class="nv">%~2</span><span class="s2">&quot;</span> nul
<span class="k">del</span> <span class="s2">&quot;</span><span class="nv">%~2</span><span class="s2">&quot;</span> <span class="p">&gt;</span> nul <span class="mi">2</span><span class="p">&gt;&amp;</span><span class="mi">1</span>i
</code></pre></div>
<h2 id="colored-text">Colored text<a class="headerlink" href="#colored-text" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="p">@</span><span class="k">echo</span> off
<span class="k">SETLOCAL</span> EnableDelayedExpansion
<span class="k">for</span> <span class="k">/F</span> <span class="s2">&quot;tokens=1,2 delims=#&quot;</span> <span class="se">%%</span>a <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;&quot;prompt #$H#$E# &amp; echo on &amp; for </span><span class="se">%%</span><span class="s1">b in (1) do     rem&quot;&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="p">(</span>
  <span class="k">set</span> <span class="s2">&quot;DEL=</span><span class="se">%%</span><span class="s2">a&quot;</span>
<span class="p">)</span>
</code></pre></div>
<p><code>...</code></p>
<div class="highlight"><pre><span></span><code><span class="k">exit</span>
<span class="p">:</span><span class="nl">colorEcho</span>
<span class="k">echo</span> off
<span class="p">&lt;</span>nul <span class="k">set</span> <span class="k">/p</span> <span class="s2">&quot;.=</span><span class="nv">%DEL%</span><span class="s2">&quot;</span> <span class="p">&gt;</span> <span class="s2">&quot;</span><span class="nv">%~2</span><span class="s2">&quot;</span>
findstr /v /a:<span class="nv">%1</span> /R <span class="s2">&quot;^$&quot;</span> <span class="s2">&quot;</span><span class="nv">%~2</span><span class="s2">&quot;</span> nul
<span class="k">del</span> <span class="s2">&quot;</span><span class="nv">%~2</span><span class="s2">&quot;</span> <span class="p">&gt;</span> nul <span class="mi">2</span><span class="p">&gt;&amp;</span><span class="mi">1</span>i
</code></pre></div>
<p>These two pieces of code (first one at the start, last one at the end of the script file) will handle the colored text in the installer. You can find more information about it in this <a href="https://stackoverflow.com/questions/4339649/how-to-have-multiple-colors-in-a-windows-batch-file/5344911#5344911">Stack Overflow question</a>.</p>
<p>The colors are called by using <code>call :colorEcho a0 "string"</code>, where <code>a0</code> is the sample color used in this example. Usually, it's better to use <code>echo.</code> in the following line.</p>
<h2 id="timeout">timeout<a class="headerlink" href="#timeout" title="Permanent link">&para;</a></h2>
<p><code>timeout /t 1 &gt; nul</code></p>
<p><code>timeout</code> is used to create a natural pause in the installation process. It's used in this installer to let the user read the text easier and artificially make the installation look less faster when multiple commands are being used. We use <code>timeout</code> together with the command <code>&gt; nul</code> to hide the information from the user and make the screen cleaner. The sample above pauses the script for one second before running the next command.</p>
<h2 id="nul">nul<a class="headerlink" href="#nul" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>timeout /t 1 <span class="p">&gt;</span> nul
<span class="k">rmdir</span> /S /Q .\CG <span class="p">&gt;</span> nul
<span class="k">echo</span> D <span class="p">|</span> xcopy /E /Y .\Managed ..\Managed <span class="p">&gt;</span> nul
</code></pre></div>
<p>The <code>nul</code> command is widely used in the script to hide information from the user. It is often used to hide irrelevant information that is verbose and takes too much screen space.</p>
<h2 id="aria2c">aria2c<a class="headerlink" href="#aria2c" title="Permanent link">&para;</a></h2>
<p><code>.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/resources/releases/download/Nipah/Onikakushi-CG.zip</code>
* <code>--file-allocation=none</code> forces <code>aria2c</code> to not allocate any space for the files. In case of failure, it will only take the actual downloaded space instead of the full space the downloaded file would normally take.
* <code>--continue=true</code> continues the download if the file already exists. Incomplete downloads will resume and complete downloads will be skipped.
* <code>-x 8</code> is the number of connections <code>aria2c</code> will make. Allows faster downloading, maximum number of connections is <strong>16</strong>.</p>
<p><code>.\aria2c.exe --file-allocation=none --continue=true -x 8 -i local.txt</code>
* <code>-i local.txt</code> uses the file <code>local.txt</code> as the input for the download. The file can contain one or more links in a vertical list.</p>
<p>We use <code>aria2c</code> because it offers us the best download speeds and flexibility. It can be easily changed for another program such as <code>wget</code> considering the changes to keep the functionality have been made in the script.</p>
<h2 id="7za">7za<a class="headerlink" href="#7za" title="Permanent link">&para;</a></h2>
<p><code>.\7za.exe x Higurashi-Textboxes.zip -aoa</code>
* <code>x</code> extracts the file with its full path.
* <code>-aoa</code> overwrite files without the user input. Useful for applying updates.</p>
<p>The reason we use 7-zip is that of <code>lzma</code>. It's free, open-source and offers a higher compression compared to <code>.rar</code> files. The software can be easily changed to any other alternatives that support the commands above. </p>
<h2 id="powershell">powershell<a class="headerlink" href="#powershell" title="Permanent link">&para;</a></h2>
<blockquote>
<p><strong>This method is broken since March 2018.</strong> We reverted to <a href="#set">set</a>. Last commit where this command was used: <a href="https://github.com/07th-mod/resources/blob/08b15f45b1ca2b1bcd77454dc9ec319006f33b52/onikakushi/install.bat">08b15f45b1</a>.</p>
</blockquote>
<p><code>powershell -command "(convertfrom-json (invoke-webrequest https://api.github.com/repos/07th-mod/onikakushi/releases/latest).content).assets.browser_download_url | set-content local.txt"</code>
* <code>powershell -command ""</code> calls Windows Powershell through the command line window and runs a command.
* <code>(convertfrom-json (invoke-webrequest https://api.github.com/repos/07th-mod/onikakushi/releases/latest).content).assets.browser_download_url</code> - a bit tricky: <code>invoke-webrequest</code> calls the link from the API to get the latest release; <code>convertfrom-json</code> converts the information to a readable state, looking especially for <code>assets.browser_download_url</code>.
* <code>|</code> - runs a follow up command.
* <code>set-content local.txt</code> - instead of outputting the result in the screen, the command saves it in the file <code>local.txt</code> for use later.</p>
<p>This command was introduced later in development. This command basically uses the Github API to get the latest release for the installed chapter. Previously, we used to add the link manually. This command eliminates the need of doing this work every time a new patch is released.</p>
<p>This command has been pretty reliable but there are cases where it will miss. It is hard to reproduce and is probably related to security settings in the end user computer. Fortunately, it seems to have a 99% uptime despite commonly showing some information that might look like an error. It can be changed by <code>grep</code> with <code>curl</code> on Linux.</p>
<h2 id="set">set<a class="headerlink" href="#set" title="Permanent link">&para;</a></h2>
<p><code>set version=v4.0.1</code>
* <code>set</code> creates a variable
* <code>version</code> is the variable name
* <code>v4.0.1</code> is the value stored in this variable</p>
<p>Since March 2018, we had to rollback to use variables to download the patch. Unfortunately, there seems to be an issue with Github and <code>Invoke-WebRequest</code> that results in a broken SSL/TLS communication. Using a variable allows us to just change a little bit of text for every update released, instead of manually fishing for every instance where the patch version is called. The downside of this method compared to powershell is that we have to manually update the installer code every time a new version is released. Powershell, though, didn't require any extra work since it would always get the latest version from the API.</p>
<p>The variable is called by using <code>%version%</code>. Like in this example: </p>
<div class="highlight"><pre><span></span><code>.\aria2c.exe --file-allocation=none --continue=true -x 8 https://github.com/07th-mod/onikakushi/releases/download/%version%/Onikakushi.Voice.and.Graphics.Patch.%version%.zip
</code></pre></div>
<h2 id="xcopy">xcopy<a class="headerlink" href="#xcopy" title="Permanent link">&para;</a></h2>
<p><code>echo D | xcopy /E /Y .\Managed ..\Managed &gt; nul</code>
* <code>echo D</code> will input automatically the <code>D</code> key, that in this command relates to copying a directory instead of a file. This allows the user to walk away from the computer and not stall the installation for a simple input.
* <code>xcopy /E /Y .\Managed ..\Managed</code>
    * <code>/E</code> will copy every subfolder, even if empty;
    * <code>/Y</code> will overwrite files with the same name without your consent (currently not very useful but still kept there);
* <code>&gt; nul</code> - like already said above, hides the information from the user. After testing, it was decided to not display the copying process since it floods the screen with information that is hard to follow (the command copies a few hundred files).</p>
<p>We employed <code>xcopy</code> because the patch use big filenames and paths. <code>move</code> turned out to be very unreliable for the amount of errors it would cause because of the long paths. Since Windows XP hasn't been used in a long while, we can safely use <code>xcopy</code> to move the folders. The downside is that we have to use extra space since it only <strong>copies</strong> the folders instead of moving them. It can be changed to <code>rsync</code> on Linux.</p>
<h2 id="rmdir-mkdir-and-del">rmdir, mkdir and del<a class="headerlink" href="#rmdir-mkdir-and-del" title="Permanent link">&para;</a></h2>
<ul>
<li><code>rmdir /S /Q .\CG &gt; nul</code><ul>
<li><code>/S</code> removes the tree (directory and subdirectories).</li>
<li><code>/Q</code> means quiet. Will remove without your consent.</li>
</ul>
</li>
<li><code>mkdir ..\StreamingAssets\BGMAlt</code> - creates folders that can be used for alternative functions implemented by the modded <a href="https://github.com/07th-mod/higurashi-dev-guides/wiki/assembly-csharp.dll">Assembly-CSharp.dll</a>.</li>
<li><code>del .\*.zip &gt; nul</code> deletes all the files with the <code>.zip</code> extension in the current folder.</li>
</ul>
<p>These are mostly used to clear up space after a successful installation. <code>mkdir</code> will create a few folders that can be used in the future, but are currently empty. This should make the process easier for modders that want to fork our work.</p>
<hr />
<h1 id="updater-code">Updater code<a class="headerlink" href="#updater-code" title="Permanent link">&para;</a></h1>
<blockquote>
<p><strong>The updater is currently broken. See <a href="#powershell">powershell</a> and <a href="#set">set</a>.</strong></p>
</blockquote>
<p><strong>Since most of the basic syntax used was also seen in the previous code, we will skip explaining those.</strong></p>
<div class="highlight"><pre><span></span><code><span class="p">@</span><span class="k">echo</span> off
<span class="k">SETLOCAL</span> EnableDelayedExpansion
<span class="k">for</span> <span class="k">/F</span> <span class="s2">&quot;tokens=1,2 delims=#&quot;</span> <span class="se">%%</span>a <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;&quot;prompt #$H#$E# &amp; echo on &amp; for </span><span class="se">%%</span><span class="s1">b in (1) do     rem&quot;&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="p">(</span>
  <span class="k">set</span> <span class="s2">&quot;DEL=</span><span class="se">%%</span><span class="s2">a&quot;</span>
<span class="p">)</span>

<span class="p">:</span><span class="nl">start</span>
<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Comparing local version to remote version...&quot;</span> <span class="p">&amp;&amp;</span> <span class="k">echo</span>:
timeout /t 3 <span class="p">&gt;</span> nul 
<span class="k">if</span> <span class="k">exist</span> local.txt <span class="p">(</span>
    <span class="k">goto</span> <span class="p">:</span><span class="nl">compare</span>
<span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
    <span class="k">echo</span> No information about the local version found. Downloading the newest remote version available...
    <span class="k">goto</span> <span class="p">:</span><span class="nl">update</span>
<span class="p">)</span>

<span class="p">:</span><span class="nl">compare</span>
<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Downloading remote information for comparison&quot;</span>
timeout /t 3 <span class="p">&gt;</span> nul
powershell -command <span class="s2">&quot;(convertfrom-json (invoke-webrequest https://api.github.com/repos/07th-mod/onikakushi/releases/latest).content).assets.browser_download_url | set-content remote.txt&quot;</span>
fc remote.txt local.txt <span class="p">&gt;</span> nul
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="k">goto</span> <span class="p">:</span><span class="nl">newver</span>

<span class="p">:</span><span class="nl">samever</span>
<span class="k">echo</span> Looks like you have the latest version already installed, nothing to do here...
<span class="k">del</span> remote.txt
<span class="k">exit</span>

<span class="p">:</span><span class="nl">newver</span>
<span class="k">echo</span> New version found, redirecting to download and installation...
<span class="k">goto</span> <span class="p">:</span><span class="nl">download</span>

<span class="p">:</span><span class="nl">update</span>
<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Downloading latest patch...&quot;</span> <span class="p">&amp;&amp;</span> <span class="k">echo</span>:
powershell -command <span class="s2">&quot;(convertfrom-json (invoke-webrequest https://api.github.com/repos/07th-mod/onikakushi/releases/latest).content).assets.browser_download_url | set-content remote.txt&quot;</span>
<span class="k">goto</span> <span class="p">:</span><span class="nl">download</span>

<span class="p">:</span><span class="nl">download</span>
.\aria2c.exe --file-allocation=none --continue=true -x 8 -i remote.txt
<span class="k">del</span> local.txt
<span class="k">ren</span> remote.txt local.txt
<span class="k">goto</span> <span class="p">:</span><span class="nl">install</span>

<span class="p">:</span><span class="nl">install</span>
<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Extracting files...&quot;</span>
<span class="k">echo</span>.
timeout /t 1 <span class="p">&gt;</span> nul
.\7za.exe x *.Voice.and.Graphics.Patch.*.zip

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Moving folders...&quot;</span>
<span class="k">echo</span>.
<span class="k">echo</span> D <span class="p">|</span> xcopy /E /Y .\Managed ..\Managed <span class="p">&gt;</span> nul
<span class="k">echo</span> D <span class="p">|</span> xcopy /E /Y .\StreamingAssets ..\StreamingAssets <span class="p">&gt;</span> nul

<span class="k">call</span> <span class="p">:</span><span class="nl">colorEcho</span> a0 <span class="s2">&quot;Deleting leftovers...&quot;</span>
<span class="k">echo</span>.
<span class="k">rmdir</span> /S /Q .\StreamingAssets <span class="p">&gt;</span> nul
<span class="k">rmdir</span> /S /Q .\Managed <span class="p">&gt;</span> nul
<span class="k">del</span> ..\StreamingAssets\CompiledUpdateScripts\*.mg <span class="p">&gt;</span> nul
<span class="k">del</span> *.zip

<span class="k">exit</span>
<span class="p">:</span><span class="nl">colorEcho</span>
<span class="k">echo</span> off
<span class="p">&lt;</span>nul <span class="k">set</span> <span class="k">/p</span> <span class="s2">&quot;.=</span><span class="nv">%DEL%</span><span class="s2">&quot;</span> <span class="p">&gt;</span> <span class="s2">&quot;</span><span class="nv">%~2</span><span class="s2">&quot;</span>
findstr /v /a:<span class="nv">%1</span> /R <span class="s2">&quot;^$&quot;</span> <span class="s2">&quot;</span><span class="nv">%~2</span><span class="s2">&quot;</span> nul
<span class="k">del</span> <span class="s2">&quot;</span><span class="nv">%~2</span><span class="s2">&quot;</span> <span class="p">&gt;</span> nul <span class="mi">2</span><span class="p">&gt;&amp;</span><span class="mi">1</span>i
</code></pre></div>
<h1 id="flowchart">Flowchart<a class="headerlink" href="#flowchart" title="Permanent link">&para;</a></h1>
<p>This flowchart shows how the updater behaves and the choices it will make:</p>
<div class="highlight"><pre><span></span><code>check if local.txt exists &gt;&gt; if it exists &gt;&gt; download remote.txt &gt;&gt; compare both files &gt;&gt; if files are the same &gt;&gt; end updating process, nothing to update
                                ^                                                         ^ if files are different &gt;&gt; download patch &gt;&gt; install and clean up files &gt;&gt; change remote.txt to local.txt
                                ^ if it doesn&#39;t exist &gt;&gt; download remote.txt &gt;&gt; download patch &gt;&gt; install and clean up files &gt;&gt; change remote.txt to local.txt
</code></pre></div>
<h2 id="if-exist">if exist<a class="headerlink" href="#if-exist" title="Permanent link">&para;</a></h2>
<p><div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="k">exist</span> local.txt <span class="p">(</span>
    <span class="k">goto</span> <span class="p">:</span><span class="nl">compare</span>
<span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
    <span class="k">echo</span> No information about the local version found. Downloading the newest remote version available...
    <span class="k">goto</span> <span class="p">:</span><span class="nl">update</span>
<span class="p">)</span>
</code></pre></div>
* <code>if exist local.txt</code> looks for the file <code>local.txt</code> (that holds the information about the current version, as seen on the previous page)
    * if it exists, it will compare the versions (see the next command)
    * if it doesn't exist (<code>else</code>), it will download the newest remote version available</p>
<p>This simple code checks if the file <code>local.txt</code> exists and proceeds to compare it to the file <code>remote.txt</code> (can be seen in the next command). If the file doesn't exist, it will proceed to download the file <code>remote.txt</code> and rename it to <code>local.txt</code> after a successful installation.</p>
<h2 id="fc">fc<a class="headerlink" href="#fc" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>fc remote.txt local.txt <span class="p">&gt;</span> nul
<span class="k">if</span> <span class="k">errorlevel</span> <span class="mi">1</span> <span class="k">goto</span> <span class="p">:</span><span class="nl">newver</span>
</code></pre></div>
<p>In case you have a file called <code>local.txt</code> in the <code>temp</code> directory, <code>fc</code> will compare the file to another file called <code>remote.txt</code> that was downloaded prior to the comparison. The result is hidden from the user since it is irrelevant to the process. <code>if errorlevel 1</code> means that if the two files are different, it will use <code>goto :newver</code> to go to the section where it will download the newest patch. If both files are the same, the updater will return a message saying that there is nothing to update.</p>
<p>The downside of this method is that both files can be tempered by the user to trigger the wrong result. It is a known flaw, but there is nothing to be afraid of as the user will most likely never touch it.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      All Nipahs Reserved
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>